# 智慧金錢概念 (Smart Money Concepts) 指標使用指南

## 概述

本項目已將 LuxAlgo 的 Smart Money Concepts PineScript 指標完整轉換為 Python，並集成到 GUI 應用中。該指標幫助交易者識別：

- **訂單區塊 (Order Blocks)** - 機構交易者可能的干預區域
- **結構打破 (Structure Breaks)** - BOS (Break of Structure) 和 CHoCH (Change of Character)
- **樞紐點 (Pivot Points)** - HH、HL、LL、LH
- **等高/低點 (Equal Highs/Lows)** - 價格相等的區域

## 文件結構

```
├── smc_indicator_complete.py        # 完整的 SMC 指標（獨立）
├── model_ensemble_gui_updated.py    # 集成 SMC 的 GUI 應用
└── SMC_USAGE.md                     # 本文件
```

## 快速開始

### 1. 安裝依賴

```bash
pip install pandas numpy matplotlib yfinance
```

### 2. 運行 GUI

```bash
python model_ensemble_gui_updated.py
```

### 3. 使用步驟

#### 步驟 1: 加載數據
- 點擊 "數據加載" 標簽
- 選擇以下任一方式：
  - **加載本地 CSV/Parquet** - 選擇本地文件
  - **加載默認數據** - 使用 data/btc_15m.parquet
  - **從 Yahoo Finance 下載** - 輸入代碼（如 BTC-USD）和時間周期（如 1y）

#### 步驟 2: 執行 SMC 分析
- 點擊 "智慧金錢概念分析" 標簽
- 調整參數：
  - **擺幅長度** (Swing Length): 檢測主要樞紐點的 K 線數 (默認: 50)
  - **內部結構長度** (Internal Length): 檢測內部結構的 K 線數 (默認: 5)
- 點擊 "分析 SMC" 按鈕

#### 步驟 3: 查看結果
- 圖表會顯示：
  - 藍色框：看跌訂單區塊 (HH→LL)
  - 綠色框：看漲訂單區塊 (LL→HH)
  - 三角形標記：樞紐點 (^=高, v=低)
  - 黃色線：BOS (結構打破)
  - 青色虛線：CHoCH (角色轉換)

#### 步驟 4: 查看統計信息
- 點擊 "統計信息" 標簽
- 查看詳細的分析結果：
  - 樞紐點數量統計
  - 訂單區塊類型分布
  - 最新樞紐點詳情

## 詳細參數說明

### 擺幅長度 (Swing Length)

**含義**: 用於檢測主要樞紐點的 K 線周期數

- **值: 10-30**
  - 檢測短期樞紐點
  - 信號較多但可靠性略低
  - 適合短線交易 (1H-4H)

- **值: 40-70** ⭐ (推薦)
  - 檢測中期樞紐點
  - 信號可靠性較好
  - 適合日內或日線交易

- **值: 100+**
  - 檢測長期樞紐點
  - 信號較少但非常可靠
  - 適合中長期交易

### 內部結構長度 (Internal Length)

**含義**: 用於檢測內部結構 (細節結構) 的 K 線周期數

- 通常設置為 3-10
- 用於識別大趨勢內的小級別結構
- 幫助確認主要樞紐點的有效性

## 指標詳解

### 訂單區塊 (Order Blocks)

**定義**: 機構交易者集中買入或賣出的區域

#### 看漲訂單區塊 (Bullish OB, 綠色)
- 從 **LL (Lower Low)** 到下一個 **HH (Higher High)** 之間形成
- 表示可能的買入支持區域
- 當價格回落到此區域時，可能出現反彈

#### 看跌訂單區塊 (Bearish OB, 藍色)
- 從 **HH (Higher High)** 到下一個 **LL (Lower Low)** 之間形成
- 表示可能的賣出阻力區域
- 當價格上升到此區域時，可能出現回落

### 結構打破 (Structure Breaks)

#### BOS (Break of Structure, 黃色線)
- **定義**: 價格突破上一個樞紐點
- **看漲 BOS**: 收盤價高於前一個高樞紐點
- **看跌 BOS**: 收盤價低於前一個低樞紐點
- **用途**: 確認趨勢延續

#### CHoCH (Change of Character, 青色虛線)
- **定義**: 市場角色改變，趨勢可能反轉
- **看漲 CHoCH**: 在下跌中出現，預示可能轉為上升
- **看跌 CHoCH**: 在上升中出現，預示可能轉為下跌
- **用途**: 識別潛在趨勢反轉點

### 樞紐點 (Pivot Points)

| 類型 | 符號 | 含義 | 特點 |
|------|------|------|------|
| **HH** | ^(紅色) | Higher High | 更高的高點，上升趨勢確認 |
| **HL** | ^(紅色) | Higher Low | 更高的低點，上升動能減弱信號 |
| **LL** | v(綠色) | Lower Low | 更低的低點，下降趨勢確認 |
| **LH** | v(綠色) | Lower High | 更低的高點，下降動能減弱信號 |

## 交易策略示例

### 1. 順勢交易 (Trend Following)

```
看漲信號:
1. 確認 HH + HL 序列 (上升樞紐點序列)
2. BOS 確認買入
3. 在綠色訂單區塊 (看漲 OB) 获得支持
4. 目標: 下一個 HH 或上方阻力

看跌信號:
1. 確認 LL + LH 序列 (下降樞紐點序列)
2. BOS 確認賣出
3. 在藍色訂單區塊 (看跌 OB) 获得阻力
4. 目標: 下一個 LL 或下方支持
```

### 2. 趨勢反轉交易 (Reversal Trading)

```
反轉信號:
1. CHoCH 出現
2. 檢查是否有未被破壞 (mitigation) 的訂單區塊
3. 在訂單區塊邊界設置進場點
4. 目標: 相反方向的下一個 HH/LL
```

### 3. 訂單區塊反彈 (Order Block Bounces)

```
綠色訂單區塊 (看漲 OB):
1. 價格回落至綠色區塊
2. 尋找買入信號 (K 線形態確認)
3. 止損: 區塊下方
4. 獲利: 上方樞紐點或阻力

藍色訂單區塊 (看跌 OB):
1. 價格上升至藍色區塊
2. 尋找賣出信號 (K 線形態確認)
3. 止損: 區塊上方
4. 獲利: 下方樞紐點或支持
```

## 實用技巧

### 1. 優化擺幅長度

```python
# 不同時間框架建議:
# 1 分鐘: swing_length = 10-20
# 5 分鐘: swing_length = 15-30
# 15 分鐘: swing_length = 20-40
# 1 小時: swing_length = 30-60
# 日線: swing_length = 50-100
# 周線: swing_length = 100+
```

### 2. 結合其他指標

- **移動平均線**: 確認主要趨勢方向
- **RSI**: 確認超買/超賣情況
- **成交量**: 確認訂單區塊重要性
- **K 線形態**: 精確進場點

### 3. 風險管理

```
位置規模計算:
風險金額 = 交易資金 × 風險百分比 (如 2%)
止損距離 = 樞紐點或訂單區塊邊界
合約規模 = 風險金額 / 止損距離
```

### 4. 過濾非交易信號

- 過濾離最近樞紐點太遠的信號
- 在重要新聞前後謹慎交易
- 優先交易多個框架對齐的信號
- 確保足夠的成交量支持

## 常見問題

### Q: 為什麼看不到任何訂單區塊？
A: 可能是擺幅長度設置不當。嘗試：
- 減小擺幅長度 (如從 50 改為 30)
- 確保圖表中有足夠的數據
- 檢查數據質量

### Q: 訂單區塊太多了，怎麼過濾？
A: 您可以：
- 增加擺幅長度以獲取更重要的區塊
- 只交易最近的/最大的訂單區塊
- 結合其他指標確認

### Q: 如何判斷訂單區塊是否有效？
A: 檢查以下標準：
- 寬度: 5-100 根 K 線
- 高度: 0.05% 至 20% 的價格動作
- 最近性: 優先最近形成的區塊
- 破壞狀態: 未被破壞的區塊更重要

### Q: 可以用於加密貨幣嗎？
A: 完全可以！該指標適用於：
- 加密貨幣 (BTC, ETH, 等)
- 股票
- 外匯
- 商品

## 致謝

感謝 [LuxAlgo](https://www.tradingview.com/u/LuxAlgo/) 開發的優秀指標。
本項目已獲得授權轉換為 Python 版本。

## 許可證

CC BY-NC-SA 4.0 - 基於 LuxAlgo 原始指標

## 技術支持

有任何問題，請提交 Issue 或查看相關代碼註解。
